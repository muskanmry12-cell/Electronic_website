<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
  <style>
    .slider {
      position: relative;
      width: 100%;
      max-width: 500px;
      height: 350px;
      margin: 20px auto;
      overflow: hidden;
      border-radius: 10px;
      border: 1px solid #ddd;
    }
    .slider img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: none;
    }
    .slider img.active {
      display: block;
    }
    .slider button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.5);
      color: white;
      border: none;
      padding: 8px 12px;
      cursor: pointer;
      border-radius: 50%;
    }
    .slider .prev { left: 10px; }
    .slider .next { right: 10px; }
  </style>
</head>
<body class="bg-gray-100">

<header class="bg-blue-600 text-white p-4 flex justify-between items-center">
  <h1 class="text-2xl font-bold cursor-pointer" onclick="window.location.href='index.html'">Elec-Mart</h1>
  <div class="flex gap-4 items-center">
    <div class="cart cursor-pointer" onclick="window.location.href='cart.html'">üõí <span id="cartCount">0</span></div>
  </div>
</header>

<main>
  <section id="productDetail" class="product-container">
    <p>Loading product details...</p>
  </section>
</main>

<script src="products.js"></script>
<script>
function updateCartCount() {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  document.querySelector('.cart span').innerText = cart.length;
}
updateCartCount();

// ‚úÖ Get product ID from URL
const params = new URLSearchParams(window.location.search);
const productId = params.get("id");

let product = null;
// Search product in all categories
Object.keys(productsData).forEach(cat => {
  productsData[cat].forEach(p => {
    if (p.id === productId) {
      product = p;
    }
  });
});

if (!product) {
  document.getElementById("productDetail").innerHTML = "<h2>Product not found</h2>";
} else {
  const container = document.getElementById("productDetail");
  container.innerHTML = `
    <div class="slider">
      ${product.images.map((img, i) => `
        <img src="${img}" class="${i === 0 ? 'active' : ''}" alt="${product.name}">
      `).join("")}
      <button class="prev">‚ùÆ</button>
      <button class="next">‚ùØ</button>
    </div>
    <h2 class="text-2xl font-bold mt-4">${product.name}</h2>
    <p class="text-green-600 text-xl font-semibold">‚Çπ${product.price}</p>
    <p class="mt-2">${product.description}</p>
    <ul class="mt-2">
  ${product.specification 
    ? Object.keys(product.specification).map(key => `
        <li><b>${key}:</b> ${product.specification[key]}</li>
      `).join("") 
    : ""}
</ul>

    <button class="mt-4 px-4 py-2 bg-blue-600 text-white rounded" onclick="addToCart()">Add to Cart</button>
  `;

  // ‚úÖ Slider logic
  const images = container.querySelectorAll(".slider img");
  let currentIndex = 0;
  const showImage = (index) => {
    images.forEach((img, i) => img.classList.toggle("active", i === index));
  };
  container.querySelector(".prev").addEventListener("click", () => {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    showImage(currentIndex);
  });
  container.querySelector(".next").addEventListener("click", () => {
    currentIndex = (currentIndex + 1) % images.length;
    showImage(currentIndex);
  });

  // ‚úÖ Add to cart function
  window.addToCart = function() {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.push(product);
    localStorage.setItem("cart", JSON.stringify(cart));
    alert(product.name + " added to cart!");
    updateCartCount();
  };
}
</script>

</body>
</html>
